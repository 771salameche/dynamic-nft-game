type Character @entity(immutable: false) {
  id: ID! # tokenId
  owner: Player!
  characterClass: String!
  level: Int!
  strength: Int!
  agility: Int!
  intelligence: Int!
  experience: Int!
  generation: Int!
  lastTrainedAt: BigInt!
  staked: Boolean!
  breedingCount: Int!
  father: Character
  mother: Character
  offspring: [Character!]! @derivedFrom(field: "father")
  fusedWith: Character
  isFused: Boolean!
}

type Player @entity(immutable: false) {
  id: ID! # address
  characters: [Character!]! @derivedFrom(field: "owner")
  tokenBalance: BigInt!
  totalStaked: Int!
  achievements: [PlayerAchievement!]! @derivedFrom(field: "player")
}

type LevelUp @entity(immutable: true) {
  id: ID!
  character: Character!
  newLevel: Int!
  blockNumber: BigInt!
  timestamp: BigInt!
}

type ExperienceGained @entity(immutable: true) {
  id: ID!
  character: Character!
  amount: Int!
  newTotalExperience: Int!
  blockNumber: BigInt!
  timestamp: BigInt!
}

type TokenTransfer @entity(immutable: true) {
  id: ID!
  from: Bytes!
  to: Bytes!
  amount: BigInt!
  blockNumber: BigInt!
  timestamp: BigInt!
}

type StakedCharacter @entity(immutable: false) {
  id: ID! # tokenId
  player: Player!
  stakedAt: BigInt!
  lastClaimAt: BigInt!
}

type RewardClaim @entity(immutable: true) {
  id: ID!
  player: Player!
  amount: BigInt!
  timestamp: BigInt!
}

type BreedingEvent @entity(immutable: true) {
  id: ID!
  parent1: Character!
  parent2: Character!
  offspring: Character!
  generation: Int!
  timestamp: BigInt!
}

type Achievement @entity(immutable: false) {
  id: ID! # achievementId
  name: String!
  tier: Int!
  players: [PlayerAchievement!]! @derivedFrom(field: "achievement")
}

type PlayerAchievement @entity(immutable: true) {
  id: ID! # player-achievementId
  player: Player!
  achievement: Achievement!
  unlockedAt: BigInt!
  xpReward: BigInt!
  tokenReward: BigInt!
}
